<!DOCTYPE html>
<html>
  <head>
    <title>Gambling</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
      /* Minimal dropdown styles to ensure dropdowns are visible and clickable */
      .dropdown { position: relative; display: inline-block; }
      .dropbtn { cursor: pointer; }
      .dropdown-content {
        display: none;
        position: absolute;
        left: 0;
        top: calc(100% + 4px);
        background: #fff;
        min-width: 160px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        z-index: 1000;
        pointer-events: auto;
        box-sizing: border-box;
      }
      .dropdown-content.show { display: block; }
      .dropdown-content button { display: block; width: 100%; text-align: left; border: none; background: transparent; padding: 8px 12px; cursor: pointer; }
      .dropdown-content button:hover { background: #f1f1f1; }
    </style>
  </head>

  <body id="mainBody" style="background-color:#010613">
    <div class="topnav" style="padding-right: 25px">
      <a href="home.html">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
          class="bi bi-house" viewBox="0 0 16 16">
          <path
            d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
        </svg>
      </a>
      <a href="simulation.html">Simulation</a>
      <a class="active" href="gambling.html">Gambling</a>
      <a href="warning.html">Warning</a>
    </div>

    <div id="dataStatus" style="color: #fff; padding: 8px 16px; font-size: 14px;"></div>

    <div class="gamblingslider" style="color: white;">
      <label for="range2" class="form-label">1</label>
      <input type="range" class="form-range" min="1" max="1000" id="range2">
      <label for="range2" class="form-label">1000</label>
      <p style="justify-self: center;">Simulations: <span id="demo"></span></p>
    </div>

    <div style="justify-self: center; display: grid; grid-template-columns: auto auto; gap: 2rem; " class="buttonsplit">
      <!-- Left Column -->
      <div style="display: grid; gap: 1rem; padding-top: 100px;">
        <!-- Team 1 -->
        <div class="dropdown" style="width: 40vw;">
          <button onclick="toggleDropdown('dropdownOne')" class="dropbtn">
            Select Team 1
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-caret-down" viewBox="0 0 16 16">
              <path
                d="M3.204 5h9.592L8 10.481zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659" />
            </svg>
          </button>
          <div id="dropdownOne" class="dropdown-content"></div>
        </div>
        
        <!-- Team 3 -->
        <div class="dropdown" style="padding-top: 150px;">
          <button onclick="toggleDropdown('dropdownThree')" class="dropbtn">
            Select Picther
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-caret-down" viewBox="0 0 16 16">
              <path
                d="M3.204 5h9.592L8 10.481zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659" />
            </svg>
          </button>
          <div id="dropdownThree" class="dropdown-content"></div>
        </div>
      </div>

      <!-- Right Column -->
      <div style="display: grid; gap: 1rem;">
        <div class="dropdown" style="align-self: start; padding-top: 100px;">
          <button onclick="toggleDropdown('dropdownTwo')" class="dropbtn">
            Select Team 2
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-caret-down" viewBox="0 0 16 16">
              <path
                d="M3.204 5h9.592L8 10.481zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659" />
            </svg>
          </button>
          <div id="dropdownTwo" class="dropdown-content"></div>
        </div>

        <div class="dropdown" style="padding-top: 150px;">
          <button onclick="toggleDropdown('dropdownFour')" class="dropbtn">
            Select Pitcher
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-caret-down" viewBox="0 0 16 16">
              <path
                d="M3.204 5h9.592L8 10.481zm-.753.659 4.796 5.48a1 1 0 0 0 1.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 0 0-.753 1.659" />
            </svg>
          </button>
          <div id="dropdownFour" class="dropdown-content"></div>
        </div>
      </div>

      
    </div>
          <div class="" style="justify-self: center; padding-top: 150px;">
              <div style="display:flex; gap:12px; align-items:flex-start; justify-content:center;">
                <div style="text-align:left; color:#fff; width:420px;">
                  <div style="display:flex; justify-content:space-between; align-items:center;"><div id="team1-lineup-title"><strong>Team 1 Lineup</strong></div><div style="font-size:12px;color:#fff;">Drag or click '+' to add batters</div></div>
                  <div id="team1-lineup" class="lineup" style="min-height:120px; background:#071227; padding:8px; border-radius:6px; margin-top:6px; display:flex; flex-direction:column; gap:6px;"></div>
                  <div style="margin-top:6px; display:flex; gap:8px; align-items:center;"><button type="button" onclick="clearLineup(1)">Clear</button></div>
                  <div style="margin-top:8px;"><strong>Available Batters</strong></div>
                  <div id="team1-roster" class="roster" style="min-height:120px; background:#0b1a2a; padding:8px; border-radius:6px; margin-top:6px; overflow:auto; max-height:220px;"></div>
                </div>

                <div style="text-align:left; color:#fff; width:420px;">
                  <div style="display:flex; justify-content:space-between; align-items:center;"><div id="team2-lineup-title"><strong>Team 2 Lineup</strong></div><div style="font-size:12px;color:#fff;">Drag or click '+' to add batters</div></div>
                  <div id="team2-lineup" class="lineup" style="min-height:120px; background:#071227; padding:8px; border-radius:6px; margin-top:6px; display:flex; flex-direction:column; gap:6px;"></div>
                  <div style="margin-top:6px; display:flex; gap:8px; align-items:center;"><button type="button" onclick="clearLineup(2)">Clear</button></div>
                  <div style="margin-top:8px;"><strong>Available Batters</strong></div>
                  <div id="team2-roster" class="roster" style="min-height:120px; background:#0b1a2a; padding:8px; border-radius:6px; margin-top:6px; overflow:auto; max-height:220px;"></div>
                </div>
              </div>

              <div style="margin-top:12px; text-align:center;">
                <button id="gotoSim" type="button" class="simbtn" onclick="saveAndGo()">Run Simulation</button>
              </div>
            </div>
          </div>

      <script>
        const teamOneButton = document.querySelector("button[onclick*='dropdownOne']");
        const playerOneButton = document.querySelector("button[onclick*='dropdownThree']");
        const teamTwoButton = document.querySelector("button[onclick*='dropdownTwo']");
        const playerTwoButton = document.querySelector("button[onclick*='dropdownFour']");

        let pitchers = []; // CSV data (pitchers only)
        let selectedTeamOne = null;
        let selectedTeamTwo = null;

        /* -------------------------------
          LOAD TEAMS
        --------------------------------*/
        fetch('teams.json')
          .then(res => res.json())
          .then(data => {
              const uniqueTeams = [...new Set(data.map(item => item.TeamName))];
              console.log('teams.json loaded — unique teams:', uniqueTeams.length);

              populateDropdown('dropdownOne', uniqueTeams, (team) => {
                  selectedTeamOne = team;
                  selectTeamOne(team);
              });

              populateDropdown('dropdownTwo', uniqueTeams, (team) => {
                  selectedTeamTwo = team;
                  selectTeamTwo(team);
              });
          })
          .catch(err => console.error('Error loading teams.json:', err));

        /* -------------------------------
          LOAD PITCHERS CSV
        --------------------------------*/
          Papa.parse("Data/API Output-Pitchers.csv", {
          download: true,
          header: true,
          skipEmptyLines: true,  // IMPORTANT FIX
            complete: function(results) {
              console.log('Papa.parse complete — rows:', results.data.length);

              pitchers = results.data
                .map(p => {
                  if (p.TeamName) p.TeamName = p.TeamName.trim();
                  if (p.PlayerName) p.PlayerName = p.PlayerName.trim();
                  if (p.Position) p.Position = p.Position.trim();
                  return p;
                })
                  .filter(p =>
                      p.TeamName &&
                      p.PlayerName &&
                      p.TeamName !== "" &&
                      p.PlayerName !== ""
                  );

                if (selectedTeamOne)
                  updatePlayerDropdown('dropdownThree', selectedTeamOne, selectPlayerOne);
                if (selectedTeamTwo)
                  updatePlayerDropdown('dropdownFour', selectedTeamTwo, selectPlayerTwo);

                console.log('pitchers processed:', pitchers.length, pitchers.slice(0,5));
          }
      });

        // Load batters CSV for rosters
        let batters = [];
        Papa.parse("Data/API Output-Batters.csv", {
          download: true,
          header: true,
          skipEmptyLines: true,
          complete: function(results) {
            batters = (results && results.data) ? results.data.map(r=>r) : [];
            console.debug('Batters parsed:', batters.length);
            // render rosters for currently selected teams
            try { renderAvailableBattersForTeam(localStorage.getItem('team1') || ''); renderAvailableBattersForTeam(localStorage.getItem('team2') || ''); } catch(e){}
          },
          error: function(err){ console.error('Failed to load batters CSV', err); document.getElementById('dataStatus').textContent += ' | Batters CSV load error'; }
        });


        /* -------------------------------
          POPULATE ANY DROPDOWN
        --------------------------------*/
        function populateDropdown(dropdownId, items, callback) {
          const container = document.getElementById(dropdownId);
          container.innerHTML = "";

          console.log('populateDropdown', dropdownId, 'itemsCount=', items.length);

            items.forEach(item => {
              const btn = document.createElement("button");
              btn.type = 'button';
              btn.textContent = item;
              // stop propagation so the global window.onclick won't immediately close the dropdown
              btn.addEventListener('click', (e) => {
                e.stopPropagation();
                callback(item);
                container.classList.remove("show");
              });
              container.appendChild(btn);
            });
        }

        /* -------------------------------
          TEAM SELECTION
        --------------------------------*/
        function selectTeamOne(team) {
            document.getElementById('dropdownOne').classList.remove('show');
            teamOneButton.innerHTML = `Team 1: ${team}`;
            localStorage.setItem('team1', team);

            updatePlayerDropdown('dropdownThree', team, selectPlayerOne);
          playerOneButton.innerHTML = "Select Pitcher";
          // render batters roster for this team
          try { document.getElementById('team1-lineup-title').innerHTML = `<strong>${team} Lineup</strong>`; renderAvailableBattersForTeam(team); } catch(e){}
        }

        function selectTeamTwo(team) {
            document.getElementById('dropdownTwo').classList.remove('show');
            teamTwoButton.innerHTML = `Team 2: ${team}`;
            localStorage.setItem('team2', team);

            updatePlayerDropdown('dropdownFour', team, selectPlayerTwo);
          playerTwoButton.innerHTML = "Select Pitcher";
          // render batters roster for this team
          try { document.getElementById('team2-lineup-title').innerHTML = `<strong>${team} Lineup</strong>`; renderAvailableBattersForTeam(team); } catch(e){}
        }

        /* -------------------------------
          PLAYER SELECTION
        --------------------------------*/
        function selectPlayerOne(player) {
            document.getElementById('dropdownThree').classList.remove('show');
            playerOneButton.innerHTML = `Pitcher: ${player}`;
            localStorage.setItem('player1', player);
            localStorage.setItem('home_pitcher', player);
        }

        function selectPlayerTwo(player) {
            document.getElementById('dropdownFour').classList.remove('show');
            playerTwoButton.innerHTML = `Pitcher: ${player}`;
            localStorage.setItem('player2', player);
            localStorage.setItem('away_pitcher', player);
        }

        /* -------------------------------
          POPULATE PLAYERS PER TEAM
        --------------------------------*/
        // Helper to detect whether a CSV row represents a pitcher.
        // Checks common field names and values (e.g. 'P', 'Pitcher').
        function isPitcher(row) {
          if (!row) return false;
          const keys = ['Position', 'Pos', 'position', 'pos', 'role', 'Role'];
          for (const k of keys) {
            if (row[k]) {
              const v = String(row[k]).toLowerCase();
              if (v === 'p' || v === 'pitcher' || v.includes('pitch')) return true;
            }
          }
          // fallback: check PlayerName or other hints (some CSVs tag pitchers differently)
          return false;
        }
        function updatePlayerDropdown(dropdownId, team, callback) {
          if (pitchers.length === 0) {
              // If CSV hasn't loaded yet, show a helpful message instead of leaving the menu blank
              populateDropdown(dropdownId, ["Pitchers not loaded yet"], () => {});
              console.warn('updatePlayerDropdown: pitchers array empty — CSV may not have loaded yet');
              return;
          }

          const pitcherList = pitchers
            .filter(p => p.TeamName && p.TeamName.trim() === team.trim() && isPitcher(p))
            .map(p => p.PlayerName.trim());

          if (pitcherList.length === 0) {
              pitcherList.push("No pitchers found");
          }

          populateDropdown(dropdownId, pitcherList, callback);
        }

        // Render available batters for the currently selected teams into the roster boxes
        function renderAvailableBattersForTeam(team) {
          const t1 = localStorage.getItem('team1') || '';
          const t2 = localStorage.getItem('team2') || '';
          const roster1 = document.getElementById('team1-roster');
          const roster2 = document.getElementById('team2-roster');
          if (roster1) roster1.innerHTML = '';
          if (roster2) roster2.innerHTML = '';

          try {
            const list1 = batters.filter(b => ((b.TeamName||b.Team||'')+'').trim() === t1.trim());
            const list2 = batters.filter(b => ((b.TeamName||b.Team||'')+'').trim() === t2.trim());
            const cur1 = getLineup(1);
            const cur2 = getLineup(2);

            if (roster1) list1.forEach(b => {
              const name = (b.PlayerName||b.Player||b.Name||'').trim();
              if (!name || cur1.includes(name)) return;
              const d = document.createElement('div');
              d.style.display = 'flex';
              d.style.justifyContent = 'space-between';
              d.style.alignItems = 'center';
              d.style.padding = '6px 8px';
              d.style.borderRadius = '6px';
              d.style.marginBottom = '6px';
              d.style.background = '#123041';
              d.style.cursor = 'grab';

              // text span (draggable)
              const span = document.createElement('span');
              span.textContent = name;
              span.style.flex = '1';
              span.draggable = true;
              span.addEventListener('dragstart', function(e){ e.dataTransfer.setData('text/plain', JSON.stringify({name:name,from:'roster',team:1})); });
              d.appendChild(span);

              // Add button to push batter into lineup
              const addBtn = document.createElement('button');
              addBtn.type = 'button';
              addBtn.textContent = '+';
              addBtn.title = 'Add to lineup';
              addBtn.style.marginLeft = '8px';
              addBtn.style.flex = '0 0 auto';
              addBtn.onclick = function(e){
                e.stopPropagation();
                const arr = getLineup(1);
                if (arr.length >= MAX_LINEUP) return alert('Lineup full (9)');
                arr.push(name);
                saveLineup(1, arr);
                renderLineup(1);
                try{ renderAvailableBattersForTeam(localStorage.getItem('team1') || ''); }catch(ex){}
              };
              d.appendChild(addBtn);

              roster1.appendChild(d);
            });

            if (roster2) list2.forEach(b => {
              const name = (b.PlayerName||b.Player||b.Name||'').trim();
              if (!name || cur2.includes(name)) return;
              const d = document.createElement('div');
              d.style.display = 'flex';
              d.style.justifyContent = 'space-between';
              d.style.alignItems = 'center';
              d.style.padding = '6px 8px';
              d.style.borderRadius = '6px';
              d.style.marginBottom = '6px';
              d.style.background = '#123041';
              d.style.cursor = 'grab';

              // text span (draggable)
              const span = document.createElement('span');
              span.textContent = name;
              span.style.flex = '1';
              span.draggable = true;
              span.addEventListener('dragstart', function(e){ e.dataTransfer.setData('text/plain', JSON.stringify({name:name,from:'roster',team:2})); });
              d.appendChild(span);

              // Add button to push batter into lineup
              const addBtn = document.createElement('button');
              addBtn.type = 'button';
              addBtn.textContent = '+';
              addBtn.title = 'Add to lineup';
              addBtn.style.marginLeft = '8px';
              addBtn.style.flex = '0 0 auto';
              addBtn.onclick = function(e){
                e.stopPropagation();
                const arr = getLineup(2);
                if (arr.length >= MAX_LINEUP) return alert('Lineup full (9)');
                arr.push(name);
                saveLineup(2, arr);
                renderLineup(2);
                try{ renderAvailableBattersForTeam(localStorage.getItem('team2') || ''); }catch(ex){}
              };
              d.appendChild(addBtn);

              roster2.appendChild(d);
            });

            // attach drop handlers to lineup containers (once)
            const l1 = document.getElementById('team1-lineup');
            const l2 = document.getElementById('team2-lineup');
            if (l1 && !l1._dragBound) {
              l1.addEventListener('dragover', e=>e.preventDefault());
              l1.addEventListener('drop', function(e){ e.preventDefault(); try{ const payload = JSON.parse(e.dataTransfer.getData('text/plain')); if (payload && payload.name){ const arr=getLineup(1); if (arr.length>=MAX_LINEUP) return alert('Lineup full (9)'); arr.push(payload.name); saveLineup(1,arr); renderLineup(1); renderAvailableBattersForTeam(1); } }catch(ex){} });
              l1._dragBound = true;
            }
            if (l2 && !l2._dragBound) {
              l2.addEventListener('dragover', e=>e.preventDefault());
              l2.addEventListener('drop', function(e){ e.preventDefault(); try{ const payload = JSON.parse(e.dataTransfer.getData('text/plain')); if (payload && payload.name){ const arr=getLineup(2); if (arr.length>=MAX_LINEUP) return alert('Lineup full (9)'); arr.push(payload.name); saveLineup(2,arr); renderLineup(2); renderAvailableBattersForTeam(2); } }catch(ex){} });
              l2._dragBound = true;
            }

          } catch (ex) { console.error(ex); }
        }

        /* -------------------------------
          OPEN/CLOSE DROPDOWNS
        --------------------------------*/
        function toggleDropdown(id) {
          document.getElementById(id).classList.toggle("show");
        }

        window.onclick = function(event) {
            if (!event.target.matches('.dropbtn') && !event.target.closest('.dropdown')) {
                document.querySelectorAll(".dropdown-content").forEach(el => el.classList.remove("show"));
            }
        };

        /* -------------------------------
          SLIDER
        --------------------------------*/
        // Lineup management: simple client-side lists (max 9 batters per team)
        const MAX_LINEUP = 9;
        function getLineup(teamNumber) {
          const key = teamNumber === 1 ? 'home_lineup' : 'away_lineup';
          const raw = localStorage.getItem(key);
          return raw ? JSON.parse(raw) : [];
        }

        function saveLineup(teamNumber, arr) {
          const key = teamNumber === 1 ? 'home_lineup' : 'away_lineup';
          localStorage.setItem(key, JSON.stringify(arr));
        }

        function renderLineup(teamNumber) {
          const container = document.getElementById(`team${teamNumber}-lineup`);
          const arr = getLineup(teamNumber);
          container.innerHTML = '';
          arr.forEach((name, i) => {
            const el = document.createElement('div');
            el.style.display = 'flex';
            el.style.justifyContent = 'space-between';
            el.style.padding = '6px';
            el.style.marginBottom = '4px';
            el.style.background = '#0f2436';
            el.style.borderRadius = '4px';
            el.innerHTML = `<span>${i+1}. ${name}</span>`;
            const rem = document.createElement('button');
            rem.type = 'button';
            rem.textContent = '✕';
            rem.style.marginLeft = '8px';
            rem.onclick = () => { arr.splice(i,1); saveLineup(teamNumber, arr); renderLineup(teamNumber); try{ renderAvailableBattersForTeam(localStorage.getItem('team1')||''); renderAvailableBattersForTeam(localStorage.getItem('team2')||''); }catch(e){} };
            el.appendChild(rem);
            container.appendChild(el);
          });
          const hint = document.createElement('div');
          hint.style.fontSize = '12px';
          hint.style.color = '#fff';
          hint.textContent = `(${arr.length}/${MAX_LINEUP})`;
          container.appendChild(hint);
        }

        function addBatter(teamNumber) {
          const input = document.getElementById(`team${teamNumber}-batter-input`);
          const name = (input.value || '').trim();
          if (!name) return alert('Enter batter name');
          const arr = getLineup(teamNumber);
          if (arr.length >= MAX_LINEUP) return alert('Lineup full (9)');
          arr.push(name);
          saveLineup(teamNumber, arr);
          input.value = '';
          renderLineup(teamNumber);
        }

        function clearLineup(teamNumber) {
          // Immediately clear the stored lineup and re-render UI.
          try {
            const key = teamNumber === 1 ? 'home_lineup' : 'away_lineup';
            // Ensure we store an empty array (avoid legacy non-JSON values)
            localStorage.setItem(key, JSON.stringify([]));
            saveLineup(teamNumber, []);
            renderLineup(teamNumber);
            // refresh available batters roster for both teams so cleared players reappear
            try{ renderAvailableBattersForTeam(localStorage.getItem('team1') || ''); renderAvailableBattersForTeam(localStorage.getItem('team2') || ''); }catch(e){}
          } catch (ex) { console.error('clearLineup error', ex); }
        }

        // Save pitcher/team selections (already saved by selection handlers) and ensure there are 9 batters each
        function saveAndGo() {
          const home = getLineup(1);
          const away = getLineup(2);
          if (home.length !== MAX_LINEUP || away.length !== MAX_LINEUP) {
            if (!confirm('Each team should have 9 batters. Continue anyway?')) return;
          }
          // ensure teams and pitchers are saved (team selection handlers already set them)
          // Save slider value to localStorage and navigate to simulation page
          try {
            var sliderEl = document.getElementById('range2');
            if (sliderEl) localStorage.setItem('num_simulations', sliderEl.value);
          } catch (e) { /* ignore */ }
          window.location.href = 'simulation.html';
        }

        // render any previously-saved lineups
        renderLineup(1);
        renderLineup(2);

        // set lineup titles from stored team names (if present)
        try{
          const t1 = localStorage.getItem('team1') || 'Team 1';
          const t2 = localStorage.getItem('team2') || 'Team 2';
          const el1 = document.getElementById('team1-lineup-title');
          const el2 = document.getElementById('team2-lineup-title');
          if (el1) el1.innerHTML = `<strong>${t1} Lineup</strong>`;
          if (el2) el2.innerHTML = `<strong>${t2} Lineup</strong>`;
        }catch(e){}

        var slider = document.getElementById("range2");
        var output = document.getElementById("demo");
        // initialize slider value from localStorage if present, otherwise default to 500
        try {
          var saved = parseInt(localStorage.getItem('num_simulations'), 10);
          if (!isNaN(saved) && slider) slider.value = saved;
          if (slider && output) output.innerHTML = slider.value;
        } catch (e) { if (slider && output) output.innerHTML = slider.value; }

        if (slider) slider.oninput = function() {
            if (output) output.innerHTML = this.value;
        }

        // Apply saved color theme on page load
        const colorThemes = { 
            default: { bg: '#010613', accent: '#031D44', container: '#071227', rosterItem: '#123041', lineupItem: '#0f2436' },
            Athletics: { bg: '#003831', accent: '#a2aaad', container: '#EFB21E', rosterItem: '#003831', lineupItem: '#003831' },
            PittsburgPirates: { bg: '#27251F', accent: '#E4002B', container: '#FDB827', rosterItem: '#27251F', lineupItem: '#27251F' },
            SanDiegoPadres: { bg: '#2F241D', accent: '#A2AAAD', container: '#FFC425', rosterItem: '#2F241D', lineupItem: '#2F241D' },
            SeattleMariners: { bg: '#0C2C56', accent: '#C4CED4', container: '#005C5C', rosterItem: '#0C2C56', lineupItem: '#0C2C56' },
            SanFranciscoGiants: { bg: '#27251F', accent: '#AE8F6F', container: '#FD5A1E', rosterItem: '#27251F', lineupItem: '#27251F' },
            StLouisCardinals: { bg: '#0C2340', accent: '#FEDB00', container: '#C41E3A', rosterItem: '#0C2340', lineupItem: '#0C2340' },
            TampaBayRays: { bg: '#8FBCE6', accent: '#F5D130', container: '#F5D130', rosterItem: '#092C5C', lineupItem: '#092C5C' },
            TexasRangers: { bg: '#003278', accent: '#C0111F', container: '#C0111F',rosterItem: '#003278', lineupItem: '#003278' },
            TorontoBlueJays: { bg: '#134A8E', accent: '#1D2D5C', container: '#E8291C', rosterItem: '#1D2D5C', lineupItem: '#1D2D5C' },
            MinnesotaTwins: { bg: '#002B5C', accent: '#D31145', container: '#D31145', rosterItem: '#002B5C', lineupItem: '#002B5C' },
            PhiladelphiaPhillies: { bg: '#E81828', accent: '#6BACE4', container: '#6BACE4', rosterItem: '#002d72', lineupItem: '#002d72' },
            AtlantaBraves: { bg: '#CE1141', accent: '#13274F', container: '#13274F', rosterItem: '#EAAA00', lineupItem: '#EAAA00' },
            ChicagoWhiteSox: { bg: '#27251F', accent: '#C4CED4', container: '#C4CED4', rosterItem: '#27251F', lineupItem: '#27251F' },
            MiamiMarlins: { bg: '#000000', accent: '#EF3340', container: '#00A3E0', rosterItem: '#EF3340', lineupItem: '#EF3340' },
            NewYorkYankees: { bg: '#0C2340', accent: '#003087', container: '#E4002C', rosterItem: '#003087', lineupItem: '#003087' },
            MilwaukeeBrewers: { bg: '#12284b', accent: '#ffc52f', container: '#ffc52f', rosterItem: '#12284b', lineupItem: '#12284b' },
            LosAngelesAngels: { bg: '#003263', accent: '#862633', container: '#BA0021',rosterItem: '#862633', lineupItem: '#862633' },
            ArizonaDiamondbacks: { bg: '#A71930', accent: '#000000', container: '#30CED8', rosterItem: '#000000', lineupItem: '#000000' },
            BaltimoreOrioles: { bg: '#000000', accent: '#DF4601', container: '#DF4601',rosterItem: '#000000', lineupItem: '#000000' },
            BostonRedSox: { bg: '#0C2340', accent: '#BD3039', container: '#BD3039',rosterItem: '#0C2340', lineupItem: '#0C2340' },
            ChicagoCubs: { bg: '#0E3386', accent: '#CC3433', container: '#CC3433', rosterItem: '#0E3386', lineupItem: '#0E3386' },
            CincinnatiReds: { bg: '#000000', accent: '#C6011F', container: '#C6011F', rosterItem: '#000000', lineupItem: '#000000' },
            ClevelandGuardians: { bg: '#00385D', accent: '#E50022', container: '#E50022', rosterItem: '#00385D', lineupItem: '#00385D' },
            ColoradoRockies: { bg: '#333366', accent: '#131413', container: '#C4CED4', rosterItem: '#131413', lineupItem: '#131413' },
            DetroitTigers: { bg: '#0C2340', accent: '#FA4616', container: '#FA4616', rosterItem: '#0C2340', lineupItem: '#0C2340' },
            HoustonAstros: { bg: '#EB6E1F', accent: '#002D62', container: '#002D62', rosterItem: '#F4911E', lineupItem: '#F4911E' },
            KansasCityRoyals: { bg: '#004687', accent: '#BD9B60', container: '#BD9B60', rosterItem: '#004687', lineupItem: '#004687' },
            LosAngelesDodgers: { bg: '#005A9C', accent: '#A5ACAF', container: '#EF3E42', rosterItem: '#A5ACAF', lineupItem: '#A5ACAF' },
            WashingtonNationals: { bg: '#AB0003', accent: '#14225A', container: '#14225A',rosterItem: '#AB0003', lineupItem: '#AB0003' },
            NewYorkMets: { bg: '#002D72', accent: '#FF5910', container: '#FF5910', rosterItem: '#002D72', lineupItem: '#002D72' }
          };

        const savedTheme = localStorage.getItem('colorTheme') || 'default';
        const theme = colorThemes[savedTheme] || colorThemes.default;
        document.getElementById('mainBody').style.backgroundColor = theme.bg;
        document.querySelector('.topnav').style.backgroundColor = theme.accent;
        
        // Apply theme to roster and lineup containers
        const rosters = document.querySelectorAll('.roster');
        rosters.forEach(el => {
          el.style.backgroundColor = theme.container;
        });
        const lineups = document.querySelectorAll('.lineup');
        lineups.forEach(el => {
          el.style.backgroundColor = theme.container;
        });
        
        // Update existing roster items with theme color
        const updateRosterItems = () => {
          const rosterItems = document.querySelectorAll('.roster > div');
          rosterItems.forEach(item => {
            item.style.background = theme.rosterItem;
          });
        };
        
        // Update existing lineup items with theme color
        const updateLineupItems = () => {
          const lineupItems = document.querySelectorAll('.lineup > div:not(:last-child)');
          lineupItems.forEach(item => {
            item.style.background = theme.lineupItem;
          });
        };
        
        updateRosterItems();
        updateLineupItems();
        
        // Hook into renderAvailableBattersForTeam to apply theme to new roster items
        const origRenderAvailableBattersForTeam = renderAvailableBattersForTeam;
        renderAvailableBattersForTeam = function(team) {
          origRenderAvailableBattersForTeam(team);
          updateRosterItems();
        };
        
        // Hook into renderLineup to apply theme to new lineup items
        const origRenderLineup = renderLineup;
        renderLineup = function(teamNumber) {
          origRenderLineup(teamNumber);
          updateLineupItems();
        };
      </script>


  </body>
</html>
